'use strict';layui.define(["default","testcode"],function(y){var f=layui.$,d=layui.layer,v=layui.util,m=layui.form,z=layui.laytpl,w=layui.dropdown,c=layui.default,a=layui.testcode,g=a.TABLENAME;layui.link(c.Paths.JS+"lib/vs/editor/editor.main.css","layui-code-vs-editor");var r=f('\x3ciframe id\x3d"Popup-View-iframe" class\x3d"Popup-View-iframe"\x3e\x3c/iframe\x3e').attr({frameborder:0,allowtransparency:!0}),x,n,p,q,t=c.Debounce(function(){q=n.getValue();a.CacheCode&&(a.Code=q,layui.data(g,{key:"Code",value:a.Code}));r.attr("srcdoc",q+"\n    \x3cstyle\x3e\n      ::-webkit-scrollbar {width: 6px;height: 6px;}\n      ::-webkit-scrollbar,::-webkit-scrollbar-corner {background: transparent;}\n      ::-webkit-scrollbar-thumb {background: rgba(0,0,0,.1);border-radius: 6px;}\n    \x3c/style\x3e\n  ")},300),h=c.Debounce(function(){requestAnimationFrame(function(){p&&n.layout()});a.CacheLayout&&(a.Layout.Code.IsMax||a.Layout.Code.IsMin||(a.Layout.Code.Width=f(".Popup-Code").width(),a.Layout.Code.Height=f(".Popup-Code").height(),a.Layout.Code.Top=f(".Popup-Code").offset().top,a.Layout.Code.Left=f(".Popup-Code").offset().left),a.Layout.View.IsMax||a.Layout.View.IsMin||(a.Layout.View.Width=f(".Popup-View").width(),a.Layout.View.Height=f(".Popup-View").height(),a.Layout.View.Top=f(".Popup-View").offset().top,a.Layout.View.Left=f(".Popup-View").offset().left),layui.data(g,{key:"Layout",value:a.Layout}))},300);f(window).on("resize",function(){h()});(function(){d.open({type:1,id:"Popup-Header",skin:"Popup-Header",title:!1,shade:0,zIndex:1,closeBtn:0,shadeClose:!1,offset:"t",anim:"slideDown",area:["100%","55px"],content:'\x3cdiv class\x3d"Popup-Loading"\x3e\x3ci class\x3d"layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"\x3e\x3c/i\x3e\x3c/div\x3e',move:!1,resize:!1,success:function(A,k,u){var e=A.find("#"+u.config.id);z(f("#test-code-header-tpl").html()).render(a,function(l){e.html(l);e.find(".CodeTips").hover(function(){var a=f(this),e=f(this).data("tips"),e=d.tips(e,this,{zIndex:d.zIndex,time:-1,tips:4,fixed:!0});a.data("index",e)},function(){d.close(f(this).data("index"))});m.render(null,"test-code-header-right-form");m.on("checkbox(test-code-header-autorun-checkbox)",function(b){b=b.elem.checked;layui.data(g,{key:"AutoRun",value:b});a.AutoRun=b;c.ok("\u5df2"+(b?"\u5f00\u542f":"\u5173\u95ed")+"\u81ea\u52a8\u8fd0\u884c",{ico:-1,zIndex:d.zIndex});b?e.find(".RunCode").addClass("layui-hide"):e.find(".RunCode").removeClass("layui-hide")});m.on("checkbox(test-code-header-cachecode-checkbox)",function(b){if(!p)return m.val("test-code-header-right-form",{CacheCode:!1}),c.no("\u7f16\u8f91\u5668\u5c1a\u672a\u51c6\u5907\u5c31\u7eea",{zIndex:d.zIndex}),!1;b=b.elem.checked;layui.data(g,{key:"CacheCode",value:b});a.CacheCode=b;b||(a.Code=null,layui.data(g,{key:"Code",value:a.Code}));b&&t();c.ok("\u5df2"+(b?"\u5f00\u542f":"\u5173\u95ed")+"\u8bb0\u5fc6\u4ee3\u7801",{ico:-1,zIndex:d.zIndex})});m.on("checkbox(test-code-header-cachelayout-checkbox)",function(b){b=b.elem.checked;layui.data(g,{key:"CacheLayout",value:b});a.CacheLayout=b;b||(a.Layout={Code:{Width:"49.5%",Height:c.Screen.Height-62,Offset:"lb",Top:62,Left:0,IsMax:!1,IsMin:!1},View:{Width:"49.5%",Height:c.Screen.Height-62,Offset:"rb",Top:62,Left:"50.5%",IsMax:!1,IsMin:!1}},layui.data(g,{key:"Layout",value:a.Layout}));b&&h();c.ok("\u5df2"+(b?"\u5f00\u542f":"\u5173\u95ed")+"\u8bb0\u5fc6\u5e03\u5c40",{ico:-1,zIndex:d.zIndex})});m.on("switch(test-code-header-theme-switch)",function(b){b=b.elem.checked;if(!p)return m.val("test-code-header-right-form",{ThemeMode:b?!1:!0}),c.no("\u7f16\u8f91\u5668\u5c1a\u672a\u51c6\u5907\u5c31\u7eea",{zIndex:d.zIndex}),!1;a.ThemeMode=b?"dark":"light";c.ToggleThemeMode(a.ThemeMode);monaco.editor.setTheme(b?"vs-dark":"vs");layui.data(g,{key:"ThemeMode",value:a.ThemeMode});c.ok(b?"\u5df2\u5f00\u542f\u6df1\u8272\u6a21\u5f0f":"\u5df2\u5f00\u542f\u6d45\u8272\u6a21\u5f0f",{ico:-1,zIndex:d.zIndex})});w.render({elem:".Version",shade:0,trigger:"hover",className:"Dropdown-Version",data:[{version:"Vs",title:"Vs \u7f16\u8f91\u5668"},{version:"Layui",title:"Layui \u7f16\u8f91\u5668"}],ready:function(a,e){e.find(".layui-icon").addClass("Down-More")},click:function(b){b=b.version;if(a.Version==b)return c.no("\u5f53\u524d\u5df2\u662f "+b+" \u7f16\u8f91\u5668",{zIndex:d.zIndex}),!1;layui.data(g,{key:"Version",value:b});a.Version=b;this.elem.find("span").text("\u5f53\u524d\u7248\u672c\uff1a"+b);c.ok("\u5207\u6362\u6210\u529f\uff0c\u5373\u5c06\u5237\u65b0\u9762\u9875...",{zIndex:d.zIndex},function(){location.reload()})},close:function(a){a.find(".layui-icon").removeClass("Down-More")}});w.render({elem:".TabSize",shade:0,trigger:"hover",className:"Dropdown-TabSize",data:[1,2,3,4,6,8,10].map(function(a){return{number:a,title:"\u7f29\u8fdb\uff1a"+a}}),ready:function(a,e){e.find(".layui-icon").addClass("Down-More")},click:function(b){if(!p)return c.no("\u7f16\u8f91\u5668\u5c1a\u672a\u51c6\u5907\u5c31\u7eea",{zIndex:d.zIndex}),!1;b=b.number;layui.data(g,{key:"TabSize",value:b});a.TabSize=b;p.updateOptions({tabSize:b,insertSpaces:!0});this.elem.find("span").text("\u7f29\u8fdb\u7a7a\u683c\uff1a"+b);c.ok("\u7f29\u8fdb\u7a7a\u683c\u5df2\u8bbe\u7f6e\u4e3a\uff1a"+b,{ico:-1,zIndex:d.zIndex})},close:function(a){a.find(".layui-icon").removeClass("Down-More")}});f(".ResetCode").on("click",c.Debounce(function(){n.setValue(v.unescape(PopupCodeHtmlVal))},300));f(".RunCode").on("click",function(){if(!p)return c.no("\u7f16\u8f91\u5668\u5c1a\u672a\u51c6\u5907\u5c31\u7eea",{zIndex:d.zIndex}),!1;t()});f(".DelCache").on("click",function(){d.confirm("\u786e\u5b9a\u6e05\u9664\u6d4f\u89c8\u5668\u5168\u90e8\u7f13\u5b58\u8bb0\u5fc6\u5417\uff1f",{title:"\u7279\u522b\u63d0\u9192",icon:0,zIndex:d.zIndex},function(){layui.data(g,null);c.ok("\u6e05\u9664\u6210\u529f\uff0c\u5373\u5c06\u5237\u65b0\u9762\u9875...",{zIndex:d.zIndex},function(){location.reload()})})})})},beforeEnd:function(){c.no("\u7f16\u8f91\u5668\u7981\u6b62\u5173\u95ed");return!1}})})();(function(){var g=f('\x3cstyle id\x3d"Popup-Code-Style"\x3e'),k="",u=f("#test-code-edit-tpl").html();d.open({type:1,id:"Popup-Code",skin:"Popup-Code",title:"HTML",shade:0,zIndex:2,closeBtn:0,maxmin:!0,shadeClose:!1,anim:"slideRight",offset:a.CacheLayout?[a.Layout.Code.Top+"px",a.Layout.Code.Left+"px"]:a.Layout.Code.Offset,area:a.CacheLayout?[a.Layout.Code.Width+"px",a.Layout.Code.Height+"px"]:[""+a.Layout.Code.Width,a.Layout.Code.Height+"px"],content:'\x3cdiv class\x3d"Popup-Loading"\x3e\x3ci class\x3d"layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"\x3e\x3c/i\x3e\x3c/div\x3e',success:function(e,l,b){d.setTop(e);a.Layout.Code.IsMax?(d.full(l),b.config.move=!1):a.Layout.Code.IsMin&&d.min(l);k=".Popup-Code .layui-layer-resize::after {width: "+e.width()+"px;}";g.html(k);f("head").append(g);f.getScript(c.Paths.JS+"lib/vs/loader.js",function(){var b=0,d=function(){clearInterval(l);clearTimeout(g);l=null},l=setInterval(function(){0<e.find(".Popup-Loading").length&&b++;10<=b&&(f("#Popup-Header").find(".Header-Error").removeClass("layui-hide").addClass("Error-Anim"),d())},1E3),g=setTimeout(function(){l&&(f("#Popup-Header").find(".Header-Error").removeClass("layui-hide").addClass("Error-Anim"),d())},1E4);require.config({paths:{vs:""+c.Paths.URL+c.Paths.JS+"lib/vs"}});require(["vs/editor/editor.main"],function(){x=f("#Popup-Code");n=monaco.editor.create(x[0],{value:a.CacheCode?a.Code:v.unescape(u),language:"html",theme:"dark"==a.ThemeMode?"vs-dark":"vs",tabSize:a.TabSize||2,folding:!0,wordWrap:"off",lineNumbers:"on",insertSpaces:!0,mouseWheelZoom:!0,foldingStrategy:!0,automaticLayout:!0,renderWhitespace:"all",roundedSelection:!1,renderIndentGuides:!0,detectIndentation:!1,minimap:{enabled:!1},scrollBeyondLastLine:!1,renderControlCharacters:!0,renderLineHighlightOnlyWhenFocus:!0,scrollbar:{horizontal:"auto",useShadows:!1,verticalScrollbarSize:8,horizontalScrollbarSize:8,alwaysConsumeMouseWheel:!1}});requestAnimationFrame(function(){d();0<e.find(".Popup-Loading").length&&e.find(".Popup-Loading").remove();p=n.getModel();q=n.getValue();r.attr("srcdoc",q+"\n    \x3cstyle\x3e\n      ::-webkit-scrollbar {width: 6px;height: 6px;}\n      ::-webkit-scrollbar,::-webkit-scrollbar-corner {background: transparent;}\n      ::-webkit-scrollbar-thumb {background: rgba(0,0,0,.1);border-radius: 6px;}\n    \x3c/style\x3e\n  ");f("#Popup-View").html(r);n.onDidChangeModelContent(function(){a.AutoRun&&t()});r.on("load",function(){f("#Popup-Header").find(".ResetCode").hasClass("layui-hide")&&f("#Popup-Header").find(".ResetCode").removeClass("layui-hide")})})})})},full:function(e,c,b){b.config.move=!1;a.Layout.Code.IsMax=!0;a.Layout.Code.IsMin=!1;h()},min:function(e,c,b){b.config.move=!0;a.Layout.Code.IsMax=!1;a.Layout.Code.IsMin=!0;h()},restore:function(e,c,b){b.config.move=!0;a.Layout.Code.IsMax=!1;a.Layout.Code.IsMin=!1;h()},resizing:function(a){var e=a.offset();a.width()+e.left>c.Screen.Width&&a.width(c.Screen.Width-e.left);a.height()+e.top>c.Screen.Height&&a.height(c.Screen.Height-e.top);k=".Popup-Code .layui-layer-resize::after {width: "+a.width()+"px;}";g.html(k);h()},moveEnd:function(a){var e=a.offset(),b=f(".Popup-Header").height()+5;e.top<b&&a.css("top",b+"px");h()},beforeEnd:function(){c.no("\u7f16\u8f91\u5668\u7981\u6b62\u5173\u95ed",{zIndex:d.zIndex});return!1}})})();(function(){var g=f('\x3cstyle id\x3d"Popup-View-Style"\x3e'),k="";d.open({type:1,id:"Popup-View",skin:"Popup-View",title:"Preview",shade:0,zIndex:3,closeBtn:0,maxmin:!0,shadeClose:!1,anim:"slideLeft",offset:a.CacheLayout?[a.Layout.View.Top+"px",a.Layout.View.Left+"px"]:a.Layout.View.Offset,area:a.CacheLayout?[a.Layout.View.Width+"px",a.Layout.View.Height+"px"]:[""+a.Layout.View.Width,a.Layout.View.Height+"px"],content:'\x3cdiv class\x3d"Popup-Loading"\x3e\x3ci class\x3d"layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"\x3e\x3c/i\x3e\x3c/div\x3e',success:function(c,e,l){d.setTop(c);a.Layout.View.IsMax?(d.full(e),l.config.move=!1):a.Layout.View.IsMin&&d.min(e);k=".Popup-View .layui-layer-resize::after {width: "+c.width()+"px;}";g.html(k);f("head").append(g)},full:function(c,e,d){d.config.move=!1;a.Layout.View.IsMax=!0;a.Layout.View.IsMin=!1;h()},min:function(c,e,d){d.config.move=!0;a.Layout.View.IsMax=!1;a.Layout.View.IsMin=!0;h()},restore:function(c,e,d){d.config.move=!0;a.Layout.View.IsMax=!1;a.Layout.View.IsMin=!1;h()},resizing:function(a){var e=a.offset();a.width()+e.left>c.Screen.Width&&a.width(c.Screen.Width-e.left);a.height()+e.top>c.Screen.Height&&a.height(c.Screen.Height-e.top);k=".Popup-View .layui-layer-resize::after {width: "+a.width()+"px;}";g.html(k);h()},moveEnd:function(a){var c=a.offset(),d=f(".Popup-Header").height()+5;c.top<d&&a.css("top",d+"px");h()},beforeEnd:function(){c.no("\u7f16\u8f91\u5668\u7981\u6b62\u5173\u95ed",{zIndex:d.zIndex});return!1}})})();y("editVs",{})});